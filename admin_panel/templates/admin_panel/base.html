<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Admin{% endblock %}</title>

  <!-- Materialize -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/materialize-css@1.0.0/dist/css/materialize.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/materialize-css@1.0.0/dist/js/materialize.min.js"></script>

  <style>
    :root{
      --ui-bg: #f4e7e0;
      --ui-shell: #efd8cd;
      --ui-card: #f7eee8;
      --ui-card-soft: #f2e0d4;
      --ui-border: rgba(156, 103, 76, 0.18);
      --ui-divider: rgba(156, 103, 76, 0.12);
      --ui-nav: #7b4f43;
      --ui-nav-2: #6f463b;
      --ui-nav-text: #fff7f2;
      --ui-text-soft: #7a6258;
      --ui-shadow: 0 8px 18px rgba(176, 120, 90, 0.08);
    }
    body{ background:var(--ui-bg); color:#3f2f29; }
    main{ padding:16px; }
    .card{
      border-radius: 14px;
      background: var(--ui-card);
      border: 1px solid var(--ui-border);
      box-shadow: var(--ui-shadow);
    }
    .card .card-content{ background: transparent; }
    .card-panel{
      background: var(--ui-card-soft);
      border: 1px solid var(--ui-border);
      border-radius: 12px;
      box-shadow: none;
    }
    .grey-text{ color: var(--ui-text-soft) !important; }
    .striped > tbody > tr:nth-child(odd){ background-color: rgba(255,255,255,.32); }
    .collection{
      border: 1px solid var(--ui-border);
    }
    .collection .collection-item{
      background: rgba(255,255,255,.35);
      border-bottom-color: var(--ui-divider);
    }
    .input-field input:focus + label{ color: #8d5a4d !important; }
    .input-field input:focus{
      border-bottom: 1px solid #8d5a4d !important;
      box-shadow: 0 1px 0 0 #8d5a4d !important;
    }
    .dropdown-content{
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid var(--ui-border);
    }
    .app-nav .nav-wrapper{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .app-nav-left{
      display:flex;
      align-items:center;
      gap:12px;
      min-width:0;
    }
    .app-nav-title{
      font-weight:700;
      color:var(--ui-nav-text);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .app-nav-right{
      display:flex;
      align-items:center;
      gap:8px;
      flex-wrap:nowrap;
      justify-content:flex-end;
      margin:0;
      flex:0 0 auto;
      min-width:0;
    }
    .app-nav-right li{ list-style:none; }
    .app-nav-right .btn-flat,
    .app-nav-right .nav-chip{
      white-space:nowrap;
      flex-shrink:0;
    }
    .app-nav .nav-chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border:1px solid rgba(255,255,255,.15);
      border-radius:999px;
      font-size:12px;
      line-height:1;
      color:var(--ui-nav-text);
      background: rgba(255,255,255,.06);
      white-space:nowrap;
    }
    .app-nav .nav-chip i{ font-size:18px; }
    .app-nav .btn-flat{
      color:var(--ui-nav-text);
      display:flex;
      align-items:center;
      gap:6px;
      border-radius:10px;
    }
    .app-nav .btn-flat:hover{ background: rgba(255,255,255,.08); }
    @media only screen and (max-width: 1280px){
      #admin_nav_date{ display:none; }
    }
    @media only screen and (max-width: 992px){
      .app-nav-title{ max-width: 180px; }
      #admin_nav_time{ display:none; }
      .app-nav-right{ gap:4px; overflow-x:auto; scrollbar-width:none; }
      .app-nav-right::-webkit-scrollbar{ display:none; }
      .app-nav-right .btn-flat{ padding:0 8px; }
    }

    /* Sidebar desktop */
    .sidenav.sidenav-fixed{
      width: 260px;
      background: var(--ui-shell);
      border-right: 1px solid var(--ui-border);
    }
    header, main, footer{
      padding-left: 260px;
    }
    @media only screen and (max-width : 992px) {
      header, main, footer{
        padding-left: 0;
      }
    }

    .brand{
      padding:16px 20px;
      font-weight:700;
      font-size:1.1rem;
      color:#4a322a;
    }
    .menu-section{
      padding: 8px 20px;
      font-size: .85rem;
      color:#777;
      color: var(--ui-text-soft);
      text-transform: uppercase;
      letter-spacing: .04em;
    }
    .sidenav li > a{
      color:#4a322a;
      border-radius:10px;
      margin: 2px 10px;
    }
    .sidenav li > a:hover{
      background: rgba(255,255,255,.45);
    }
    .sidenav li > a i.material-icons{
      color:#8a5f50;
    }
    /* === Modal centrado (compensa sidenav fijo en desktop) === */
    .modal {
      left: 50% !important;
      transform: translateX(-50%) !important;
      right: auto !important;
      margin: 0 !important;
    }

    /* En pantallas grandes, mantenemos un ancho cómodo */
    @media only screen and (min-width: 993px) {
      .modal {
        width: 60% !important;
        max-width: 720px;
      }
    }

    /* En mobile que use casi toda la pantalla */
    @media only screen and (max-width: 992px) {
      .modal {
        width: 92% !important;
      }
    }

  </style>
</head>

<body>
  <!-- Topbar -->
  <header>
    <nav class="app-nav" style="background: linear-gradient(180deg, var(--ui-nav) 0%, var(--ui-nav-2) 100%); border-bottom:1px solid rgba(0,0,0,.08);">
      <div class="nav-wrapper container">
        <div class="app-nav-left">
          <a href="#" data-target="admin-sidenav" class="sidenav-trigger" style="color:var(--ui-nav-text); margin:0;">
            <i class="material-icons">menu</i>
          </a>
          <span class="app-nav-title">
            {% block header_title %}Panel de administración{% endblock %}
          </span>
        </div>

        <ul class="app-nav-right">
          <li>
            <a class="btn-flat waves-effect" href="{% url 'core:dashboard' %}">
              <i class="material-icons">dashboard</i>Dashboard
            </a>
          </li>
          <li>
            <a class="btn-flat waves-effect" href="{% url 'caja:pos' %}">
              <i class="material-icons left">point_of_sale</i>Caja
            </a>
          </li>
          <li>
            <a class="btn-flat waves-effect" href="{% url 'admin_panel:dashboard' %}">
              <i class="material-icons">admin_panel_settings</i>Admin Panel
            </a>
          </li>
          <li>
            <span class="nav-chip" id="admin_nav_date">
              <i class="material-icons">calendar_today</i>--/--/----
            </span>
          </li>
          <li>
            <span class="nav-chip" id="admin_nav_time">
              <i class="material-icons">schedule</i>--:--
            </span>
          </li>
          <li>
            <a class="dropdown-trigger btn-flat waves-effect" href="#!" data-target="admin_user_dd">
              <i class="material-icons">account_circle</i>{{ request.user.get_username }}
              <i class="material-icons right">arrow_drop_down</i>
            </a>
          </li>
        </ul>
      </div>
    </nav>
  </header>

  <ul id="admin_user_dd" class="dropdown-content">
    <li><a href="/admin/password_change/" target="_blank"><i class="material-icons">lock</i>Cambiar clave</a></li>
    <li class="divider" tabindex="-1"></li>
    <li><a href="{% url 'logout' %}"><i class="material-icons">logout</i>Salir</a></li>
  </ul>

  <!-- Sidebar -->
  <ul id="admin-sidenav" class="sidenav sidenav-fixed">
    <li class="brand">Sistema de Ventas</li>

    <li class="menu-section">Principal</li>
    <li>
      <a href="{% url 'admin_panel:dashboard' %}">
        <i class="material-icons">dashboard</i>Dashboard
      </a>
    </li>

    <div class="menu-section">Gestión</div>

    {# Catálogo (wrapper o link directo) #}
    <li>
      <a href="{% url 'admin_panel:catalogo_home' %}">
        <i class="material-icons">inventory_2</i>Catálogo
      </a>
    </li>

    <li>
      <a href="{% url 'admin_panel:ventas_lista' %}">
        <i class="material-icons">receipt_long</i>Ventas
      </a>
    </li>

    <li>
      <a href="{% url 'admin_panel:usuarios_lista' %}">
        <i class="material-icons">people</i>Usuarios
      </a>
    </li>
    <li>
      <a href="{% url 'admin_panel:settings' %}">
        <i class="material-icons">settings</i>Configuración
  </a>
</li>
<li>
  <a href="{% url 'admin_panel:balances' %}">
    <i class="material-icons">insights</i>Balances
  </a>
</li>
<li>
  <a href="{% url 'admin_panel:tarjetas' %}">
    <i class="material-icons">credit_card</i>Tarjetas
  </a>
</li>
<li>
  <a href="{% url 'admin_panel:cc_lista' %}">
    <i class="material-icons">account_balance_wallet</i>Cuentas corrientes
  </a>
</li>
  </ul>
  

  <main>
    {% if messages %}
  {% for message in messages %}
    {% if message.tags == "success" %}
      <div class="card-panel green lighten-4 green-text text-darken-4">{{ message }}</div>
    {% elif message.tags == "error" %}
      <div class="card-panel red lighten-4 red-text text-darken-4">{{ message }}</div>
    {% elif message.tags == "warning" %}
      <div class="card-panel yellow lighten-4 brown-text text-darken-4">{{ message }}</div>
    {% else %}
      <div class="card-panel blue lighten-4 blue-text text-darken-4">{{ message }}</div>
    {% endif %}
  {% endfor %}
{% endif %}

    {% block content %}{% endblock %}
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const sidenavs = document.querySelectorAll('.sidenav');
      M.Sidenav.init(sidenavs, {});
    });
    
    document.addEventListener('DOMContentLoaded', function() {
      M.Sidenav.init(document.querySelectorAll('.sidenav'), {});
      M.Modal.init(document.querySelectorAll('.modal'), {});
      M.FormSelect.init(document.querySelectorAll('select'), {});
      M.Dropdown.init(document.querySelectorAll('.dropdown-trigger'), { coverTrigger:false, constrainWidth:false });
    });

    document.addEventListener('DOMContentLoaded', function() {
      const dateEl = document.getElementById('admin_nav_date');
      const timeEl = document.getElementById('admin_nav_time');
      function tickNavClock(){
        const d = new Date();
        const dd = String(d.getDate()).padStart(2, '0');
        const mm = String(d.getMonth() + 1).padStart(2, '0');
        const yyyy = d.getFullYear();
        const hh = String(d.getHours()).padStart(2, '0');
        const mi = String(d.getMinutes()).padStart(2, '0');
        if (dateEl) dateEl.innerHTML = '<i class="material-icons">calendar_today</i> ' + dd + '/' + mm + '/' + yyyy;
        if (timeEl) timeEl.innerHTML = '<i class="material-icons">schedule</i> ' + hh + ':' + mi;
      }
      tickNavClock();
      setInterval(tickNavClock, 10000);
    });


  </script>

  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</body>
</html>
